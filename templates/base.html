{% load static %}
<!doctype html>
<html lang="en">
  <head>
    {% block meta %}
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    {% endblock %}

    {% block corecss %}
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css/base.css' %}">
    {% endblock %}
    
    <title>Keep It SWEET! {% block extra_title %}{% endblock %}</title>
  </head>
  <body class="{% block body_class %}{% endblock %}">
    <div class="page-container d-flex flex-column min-vh-100">
      <header>
        <!-- Header Content -->
      </header>

      {% block content %}{% endblock %}

      <footer>{% include 'includes/footer.html' %}</footer>

      <!-- Cookie Banner -->
      <div id="cookie-banner" style="position: fixed; bottom: 0; width: 100%; background-color: #f8d7da; color: #721c24; padding: 10px; text-align: center; z-index: 1000;">
        This site uses cookies, including third-party cookies for secure payments. 
        <a href="/privacy-policy">Learn more</a>.
        <button id="accept-cookies" style="margin-left: 10px; padding: 5px 10px; background-color: #721c24; color: white; border: none; cursor: pointer;">Accept</button>
      </div>
    </div>

    {% block postloadjs %}
    <script>
      // Cookie Banner Logic
      document.addEventListener('DOMContentLoaded', function () {
          const cookieBanner = document.getElementById('cookie-banner');
          const acceptCookiesButton = document.getElementById('accept-cookies');

          // Hide banner if cookies are already accepted
          if (localStorage.getItem('cookiesAccepted') === 'true') {
              cookieBanner.style.display = 'none';
          }

          // Accept cookies and hide banner
          acceptCookiesButton.addEventListener('click', function () {
              localStorage.setItem('cookiesAccepted', 'true');
              cookieBanner.style.display = 'none';
          });
      });
    </script>

    <!-- Conditionally Load Stripe Script -->
    {% if 'checkout' in request.path %}
    <script src="https://js.stripe.com/v3/"></script>
    {% endif %}
    {% endblock %}
  </body>
</html>
